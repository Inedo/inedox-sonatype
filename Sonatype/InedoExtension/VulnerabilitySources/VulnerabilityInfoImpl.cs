using System;
using Inedo.Extensibility.VulnerabilitySources;
using Inedo.Feeds;

namespace Inedo.Extensions.Sonatype.VulnerabilitySources
{
    internal sealed class VulnerabilityInfoImpl : VulnerabilityInfo
    {
        public VulnerabilityInfoImpl(Vulnerability vulnerability, PackageCoordinate package)
        {
            this.Id = vulnerability.Id;
            this.FeedType = package.Package.FeedType;
            this.PackageName = package.Package.Name;
            this.PackageVersions = PackageCoordinate.DecodeVersonRange(Uri.UnescapeDataString(vulnerability.AffectedVersions));
            this.Title = vulnerability.Title;
            this.Description = vulnerability.Description;
        }

        public override string Id { get; }
        public override FeedType FeedType { get; }
        public override string PackageName { get; }
        public override VulnerabilityPackageVersionRange PackageVersions { get; }
        public override string Title { get; }
        public override string Description { get; }
    }
}
