using Newtonsoft.Json;
using System;
using System.Collections.Generic;

namespace Inedo.Extensions.Sonatype.VulnerabilitySources
{
    public sealed partial class OSSIndexVulnerabilitySource
    {
        [JsonObject]
        private sealed partial class PackageVulnerabilities
        {
            [JsonProperty("id")]
            public long ID { get; set; }
            [JsonProperty("pm")]
            public string PackageManager { get; set; }
            [JsonProperty("group")]
            public string Group { get; set; }
            [JsonProperty("name")]
            public string Name { get; set; }
            [JsonProperty("vulnerability-total")]
            public int TotalVulnerabilities { get; set; }
            [JsonProperty("vulnerability-matches")]
            public int MatchedVulnerabilities { get; set; }
            [JsonProperty("vulnerabilities")]
            public List<Vulnerability> Vulnerabilities { get; } = new List<Vulnerability>();

            private bool IsMatch(PackageId id)
            {
                return string.Equals(this.PackageManager, id.PackageManager, StringComparison.OrdinalIgnoreCase)
                    && string.Equals(this.Group, id.Group, StringComparison.OrdinalIgnoreCase)
                    && string.Equals(this.Name, id.Name, StringComparison.OrdinalIgnoreCase);
            }
        }
    }
}
