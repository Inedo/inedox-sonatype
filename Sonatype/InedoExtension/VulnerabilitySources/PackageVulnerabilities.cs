using System.Collections.Generic;
using Newtonsoft.Json;

namespace Inedo.Extensions.Sonatype.VulnerabilitySources
{
    [JsonObject]
    internal sealed class PackageVulnerabilities
    {
        [JsonProperty("coordinates")]
        public string Coordinates { get; set; }
        [JsonIgnore]
        public string Type => this.Coordinates.Substring(this.Coordinates.IndexOf(':') + 1, this.Coordinates.IndexOf('/') - this.Coordinates.IndexOf(':') - 1);
        [JsonIgnore]
        private string FullName => this.Coordinates.Substring(this.Coordinates.IndexOf('/') + 1, this.Coordinates.IndexOf('@') - this.Coordinates.IndexOf('/') - 1);
        [JsonIgnore]
        public string Group => this.FullName.LastIndexOf('/') == -1 ? null : this.FullName.Substring(0, this.FullName.LastIndexOf('/'));
        [JsonIgnore]
        public string Name => this.FullName.LastIndexOf('/') == -1 ? this.FullName : this.FullName.Substring(this.FullName.LastIndexOf('/') + 1);
        [JsonProperty("description")]
        public string Description { get; set; }
        [JsonProperty("reference")]
        public string Reference { get; set; }
        [JsonProperty("vulnerabilities")]
        public List<Vulnerability> Vulnerabilities { get; } = new List<Vulnerability>();
    }
}
